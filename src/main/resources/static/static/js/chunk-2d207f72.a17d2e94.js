(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d207f72"],{a37a:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"queryForm",attrs:{"label-width":"70px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入用户名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.name,callback:function(t){e.$set(e.queryParams,"name",t)},expression:"queryParams.name"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"工号",prop:"tutorId"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入用户工号",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.tutorId,callback:function(t){e.$set(e.queryParams,"tutorId",t)},expression:"queryParams.tutorId"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"角色",prop:"roleName"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"用户角色",clearable:"",size:"small"},model:{value:e.queryParams.roleId,callback:function(t){e.$set(e.queryParams,"roleId",t)},expression:"queryParams.roleId"}},[a("el-option",{attrs:{label:"院系秘书",value:"2"}}),a("el-option",{attrs:{label:"研究生院管理员",value:"4"}}),a("el-option",{attrs:{label:"社科处管理员",value:"6"}}),a("el-option",{attrs:{label:"科研处管理员",value:"7"}})],1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-col",{attrs:{span:6,offset:6}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.handleQuery}},[e._v("搜索")])],1),a("el-col",{attrs:{span:6,offset:2}},[a("el-button",{attrs:{icon:"el-icon-refresh",size:"small"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1)],1)],1),a("el-row",{attrs:{gutter:20}},[a("el-col",[a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAdd}},[e._v("新增 ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.userList}},[a("el-table-column",{attrs:{type:"index",align:"center",width:"60"}}),a("el-table-column",{attrs:{label:"学工号",align:"center",prop:"tutorId"}}),a("el-table-column",{attrs:{label:"姓名",align:"center",prop:"name"}}),a("el-table-column",{attrs:{label:"院系",align:"center",prop:"organizationName"}}),a("el-table-column",{attrs:{label:"用户角色",align:"center",prop:"roleName"}}),a("el-table-column",{attrs:{label:"创建时间",align:"center",prop:"createTime"}}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding"},scopedSlots:e._u([{key:"default",fn:function(t){return 1!==t.row.userId?[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("修改 ")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row.tutorId)}}},[e._v("删除 ")])]:void 0}}],null,!0)})],1),a("el-row",{attrs:{type:"flex",justify:"center"}},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],staticStyle:{margin:"5px 0"},attrs:{"current-page":e.queryParams.pageNum,"page-size":e.queryParams.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)],1),a("el-dialog",{attrs:{title:e.isEdit?"编辑用户":"添加用户",visible:e.open},on:{"update:visible":function(t){e.open=t}}},[a("el-form",{ref:"form",attrs:{"label-width":"80px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"学工号"}},[a("el-autocomplete",{staticClass:"inline-input",staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.querySearch,placeholder:"请输入学工号","trigger-on-focus":!1,disabled:e.isEdit},on:{select:e.handleSelect},model:{value:e.tutorId,callback:function(t){e.tutorId=t},expression:"tutorId"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"用户姓名",prop:"name"}},[a("p",{domProps:{textContent:e._s(e.name)}})])],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"角色"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择"},model:{value:e.roleId,callback:function(t){e.roleId=t},expression:"roleId"}},[a("el-option",{attrs:{label:"院系秘书",value:"2"}}),a("el-option",{attrs:{label:"研究生院管理员",value:"4"}}),a("el-option",{attrs:{label:"社科处管理员",value:"6"}}),a("el-option",{attrs:{label:"科研处管理员",value:"7"}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"机构"}},[a("p",{domProps:{textContent:e._s(e.organizationName)}})])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancel}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.commitSystemUser}},[e._v("确 定")])],1)],1)],1)},n=[],r=(a("b0c0"),a("159b"),a("99af"),a("b775"));function o(e){return Object(r["a"])({url:"/admin/system-user/getAll",method:"post",data:e})}function s(e){return Object(r["a"])({url:"/admin/system-user/getQueryTutorId/".concat(e),method:"get"})}function i(e){return Object(r["a"])({url:"/admin/system-user/getSystemUserByTutorId/".concat(e),method:"get"})}function u(e,t){return Object(r["a"])({url:"/admin/system-user/addSystemUser/".concat(t),method:"post",data:e})}function c(e,t){return Object(r["a"])({url:"/admin/system-user/editSystemUser/".concat(e,"/").concat(t),method:"get"})}function d(e){return Object(r["a"])({url:"/admin/system-user/deleteSystemUser/".concat(e),method:"get"})}var m={data:function(){return{loading:!0,single:!1,total:0,userList:[],isEdit:!1,open:!1,currentPage:1,statusOptions:[{dictLabel:"启用",dictValue:0},{dictLabel:"禁用",dictValue:1}],organizationOptions:[],tutorId:"",name:"",organizationName:"",roleId:"",queryParams:{pageNum:1,pageSize:10,tutorId:"",name:"",roleId:""},user:null}},created:function(){this.getList()},methods:{getList:function(){var e=this;this.loading=!0,this.queryParams.pageNum=this.currentPage||1,o(this.queryParams).then((function(t){console.log(t),e.userList=t.data.users,e.total=t.data.total,e.loading=!1})).catch((function(e){throw e}))},querySearch:function(e,t){console.log("tutorId",e),this.name="",this.organizationName="",s(e).then((function(e){var a=[];e.data.forEach((function(e){a.push({value:e})})),t(a)}))},handleSelect:function(e){var t=this;console.log(e.value),i(e.value).then((function(e){console.log(e),t.organizationName=e.data.organizationName,t.name=e.data.name,t.user=e.data})).catch((function(e){throw e}))},commitSystemUser:function(){var e=this;this.isEdit?(console.log(this.tutorId),console.log(this.roleId),c(this.tutorId,this.roleId).then((function(t){2e4===t.code&&(e.open=!1,e.$message.success("修改成功"),e.tutorId="",e.name="",e.organizationName="",e.roleId="",e.getList())}))):null!==this.user&&""!==this.roleId?(console.log(this.user,this.roleId),u(this.user,this.roleId).then((function(t){console.log(t),20001===t.code?e.$message.warning("此用户已经存在，若需修改权限，请在页面中修改"):e.$message.success("添加成功！"),e.open=!1,e.tutorId="",e.name="",e.organizationName="",e.roleId="",e.user=null,e.getList()})).catch((function(e){throw e}))):this.$message.error("请填写信息")},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={userId:void 0,deptId:void 0,userName:void 0,status:"0",remark:void 0,postIds:[],roleIds:[]}},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.queryParams={pageNum:1,pageSize:10,tutorId:"",name:"",roleId:""},this.handleQuery()},handleAdd:function(){this.open=!0,this.isEdit=!1},handleEdit:function(e){this.isEdit=!0,this.open=!0,this.tutorId=e.tutorId,this.name=e.name,this.roleId=e.roleId+"",this.organizationName=e.organizationName},handleDelete:function(e){var t=this;this.$confirm('是否确认删除？删除不可撤销，请谨慎操作"！',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){d(e).then((function(e){2e4===e.code&&(t.$message.success("删除成功"),t.getList())}))}))},handleCurrentChange:function(e){this.currentPage=e,this.getList()}}},p=m,h=a("2877"),g=Object(h["a"])(p,l,n,!1,null,null,null);t["default"]=g.exports}}]);